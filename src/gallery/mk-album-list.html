<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/app-layout/app-grid/app-grid-style.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="./fotomoto-plugin.html">
<link rel="import" href="./mk-photo-viewer-behavior.html">
<link rel="import" href="./mk-photo.html">
<link rel="import" href="../shared-styles.html">
<link rel="import" href="../mk-base-behavior.html">
<link rel="import" href="./mk-photo-styles.html">


<dom-module id="mk-album-list">
    <template>
        <style include="shared-styles mk-photo-styles">
             :host {
                display: block;
                --app-grid-columns: 6;
                --app-grid-expandible-item-columns: 6;
            }

            ul {
                list-style: none;
                display: flex;
            }
        </style>
        <iron-ajax id="flickrRequest" auto url="https://api.flickr.com/services/rest" loading="{{loading}}" handle-as="json" on-response="handleFlickrResponse"
            debounce-duration="300" params="{{getAlbumsParams(1)}}">
        </iron-ajax>
        <ul class="app-grid">
            <template is="dom-repeat" items="{{albums}}" as="album">
                <li class="item" data-index$="[[index]]" on-tap="selectPhoto" style$="[[getImageListStyle(album, 'n')]]">
                    <div class="photo-title">
                        [[album.title._content]]
                    </div>
                </li>
            </template>
        </ul>
    </template>

    <script>
        class MkAlbumList extends BaseBehavior(PhotoViewerBehavior(Polymer.GestureEventListeners(Polymer.Element))) {
            static get is() {
                return 'mk-album-list';
            }
            static get properties() {
                return {
                    queryParams: Object,
                    active: Boolean,
                    albums: Array,
                    loading: {
                        notify: true
                    }
                };
            }
            ready() {
                super.ready();
            }

            handleFlickrResponse(event) {
                let responseMeta = event.detail.response.photosets;
                this.albums = responseMeta.photoset;
            }
            _requestPhotos() {
                this.$.flickrRequest.params = {};
                this.$.flickrRequest.generateRequest();
            }

        }
        customElements.define(MkAlbumList.is, MkAlbumList);
    </script>
</dom-module>